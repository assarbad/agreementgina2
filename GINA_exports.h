/*
//-----------------------------------------------------------------------------
// There will be some overlapping names, therefore this area is commented!!!
// This is more thought to be a reference!
//-----------------------------------------------------------------------------
// Windows 2000 Professional Logo (413x72@8BPP)
#define                 IDB_W2KPRO_LOGO_SMALL8BPP       101
// Windows 2000 Server Logo (413x113@4BPP)
#define                 IDB_W2KSRV_LOGO_BIG4BPP         102
// Bluebar Logo (413x5@8BPP)
#define                 IDB_BLUEBAR8BPP                 103
// Windows 2000 Professional Logo (413x88@8BPP)
#define                 IDB_W2KPRO_LOGO_MEDIUM8BPP      107
// Windows 2000 Professional Logo (413x88@4BPP)
#define                 IDB_W2KPRO_LOGO_MEDIUM4BPP      111
// Windows 2000 Server Logo (413x88@4BPP)
#define                 IDB_W2KSRV_LOGO_MEDIUM4BPP      112
// Windows 2000 Professional Logo (413x72@4BPP)
#define                 IDB_W2KPRO_LOGO_SMALL4BPP       113
// Windows 2000 Server Logo (413x72@4BPP)
#define                 IDB_W2KSRV_LOGO_SMALL4BPP       114
// Bluebar Logo (413x5@4BPP)
#define                 IDB_BLUEBAR4BPP                 117
// Windows 2000 Advanced Server Logo (413x72@4BPP)
#define                 IDB_W2KADV_LOGO_SMALL4BPP       118
// Windows 2000 Advanced Server Logo (413x88@4BPP)
#define                 IDB_W2KADV_LOGO_MEDIUM4BPP      119
// Windows 2000 Advanced Server Logo (413x113@4BPP)
#define                 IDB_W2KADV_LOGO_BIG4BPP         120
// Windows 2000 Datacenter Server Logo (413x72@4BPP)
#define                 IDB_W2KDCS_LOGO_SMALL4BPP       121
// Windows 2000 Datacenter Server Logo (413x88@4BPP)
#define                 IDB_W2KDCS_LOGO_MEDIUM4BPP      122
// Windows 2000 Datacenter Server Logo (413x113@4BPP)
#define                 IDB_W2KDCS_LOGO_BIG4BPP         123
// MS Windows Powered Logo (413x72@4BPP)
#define                 IDB_MSW_POWERED_SMALL4BPP       124
// MS Windows Powered Logo (413x88@4BPP)
#define                 IDB_MSW_POWERED_MEDIUM4BPP      125
// MS Windows Powered Logo (413x113@4BPP)
#define                 IDB_MSW_POWERED_BIG4BPP         126
// Network interrupted (ICON)
#define                 IDI_NONETWORK                   13
// Key symbol (ICON)
#define                 IDI_KEYSYMBOL                   21
// Computer symbol (ICON)
#define                 IDI_COMPUTERSYMBOL              22
// Keyboard symbol (ICON)
#define                 IDI_KEYBOARDSYMBOL              109
// Smartcard-Reader symbol (ICON)
#define                 IDI_SMARTCARDSYMBOL             110
// Computer-Locked symbol (ICON)
#define                 IDI_MACHINELOCKEDSYMBOL         115
//-----------------------------------------------------------------------------
// "Please wait for domain list to be created"-dialog
#define                 IDD_WAITFORDOMAINLISTDLG        104
#define                 IDC_STATIC_WAIT                 101
//-----------------------------------------------------------------------------
// Logon-Help (how to use Ctrl+Alt+Del)
#define                 IDD_LOGONHELPDLG                109
// IDOK
#define                 IDC_EDIT_DESCRIPTION            2411
#define                 IDC_ANIMATE_HELP                2412
#define                 IDC_STATIC_USECTRLALTDEL        2414
#define                 IDC_STATIC_CTRL                 2415
#define                 IDC_STATIC_ALT                  2416
#define                 IDC_STATIC_DEL                  2417
//-----------------------------------------------------------------------------
// Some Smartcard-related dialog
#define                 IDD_SMARTCARDDLG                1400
#define                 IDC_STATIC_CAD                  2409
#define                 IDC_ICON_KEYBOARD               2408
#define                 IDC_ICON_SMARTCARD              2407
#define                 IDC_LINK_HELP                   2410
//-----------------------------------------------------------------------------
// The real logon dialog
#define                 IDD_LOGONDLG                    1500
#define                 IDC_STATIC_USERNAME             1506
#define                 IDC_EDIT_USERNAME               1502
#define                 IDC_STATIC_PASSWORD             1507
#define                 IDC_EDIT_PASSWORD               1503
#define                 IDC_STATIC_DOMAIN               1508
#define                 IDC_COMBO_DOMAIN                1504
#define                 IDC_CHECK_RAS                   1505
#define                 IDC_ICON_KBDLAYOUT              2406
// IDOK
// IDCANCEL
#define                 IDC_BTN_SHUTDOWN                1501
#define                 IDC_BTN_OPTIONS                 1514
#define                 IDC_STATIC_LEGALNOTES           2400
//-----------------------------------------------------------------------------
// Dialog which notifies that only the local profile is being used
#define                 IDD_LOCALPROFILEUSEDDLG         1600
#define                 IDC_STATIC_TEXT1                1601
#define                 IDC_STATIC_TEXT1                1602
// IDOK
#define                 IDC_CHECK_DONTSHOWAGAIN         1603
#define                 IDC_ICON_1                      1604
//-----------------------------------------------------------------------------
// Password change dialog
#define                 IDD_CHANGEPASSWORDDLG           1700
#define                 IDC_STATIC_USERNAME             1701
#define                 IDC_EDIT_USERNAME               1702
#define                 IDC_STATIC_DOMAIN               1703
#define                 IDC_COMBO_DOMAIN                1704
#define                 IDC_STATIC_OLDPASSWORD          1705
#define                 IDC_EDIT_OLDPASSWORD            1706
#define                 IDC_STATIC_NEWPASSWORD          1707
#define                 IDC_EDIT_NEWPASSWORD            1708
#define                 IDC_STATIC_CONFIRMPASSWORD      1709
#define                 IDC_EDIT_CONFIRMPASSWORD        1710
#define                 IDC_ICON_KEY                    2406
// IDOK
// IDCANCEL
//-----------------------------------------------------------------------------
// Windows security dialog
#define                 IDD_WINSECDLG                   1800
#define                 IDC_BTN_LOCK                    1800
#define                 IDC_BTN_LOGOFF                  1801
#define                 IDC_BTN_SHUTDOWN                1802
#define                 IDC_BTN_CHANGEPASS              1803
#define                 IDC_BTN_TASKMAN                 1804
// IDCANCEL
#define                 IDC_STATIC_TASKMANDESC          1805
#define                 IDC_GROUP_INFOS                 1657
#define                 IDC_STATIC_LOGONNAME            1806
#define                 IDC_STATIC_LOGONDATETEXT        1659
#define                 IDC_STATIC_LOGONDATE            1807
//-----------------------------------------------------------------------------
// Computer locked dialog
#define                 IDD_MACHINELOCKEDDLG            1900
#define                 IDC_STATIC_LOCKEDTEXT           1752
#define                 IDC__STATIC_LOGGEDONTEXT        1902
#define                 IDC_STATIC_UNLOCKTEXT           1754
#define                 IDC_ICON_LOCKED                 2403
//-----------------------------------------------------------------------------
// Unlock Computer dialog
#define                 IDD_UNLOCKMACHINEDLG            1950
#define                 IDC_STATIC_TEXT1                1852
#define                 IDC_STATIC_TEXT2                1952
#define                 IDC_STATIC_USERNAME             1858
#define                 IDC_EDIT_USERNAME               1953
#define                 IDC_STATIC_PASSWORD             1931
#define                 IDC_EDIT_PASSWORD               1954
#define                 IDC_STATIC_DOMAIN               1957
#define                 IDC_COMBO_DOMAIN                1956
#define                 IDC_ICON_1                      2406
// IDOK
// IDCANCEL
#define                 IDC_BTN_OPTIONS                 2401
#define                 IDC_ICON_2                      2404
//-----------------------------------------------------------------------------
// Shutdown Computer dialog
#define                 IDD_SHUTDOWNDLG                 2200
#define                 IDC_COMBO_SHUTDOWNOPTIONS       2201
#define                 IDC_STATIC_TEXT1                2202
// IDOK
// IDCANCEL
#define                 IDC_BTN_HELP                    9
//-----------------------------------------------------------------------------
// Shutdown to Install dialog
#define                 IDD_SHUTDOWNINSTALLDLG          2203
#define                 IDC_COMBO_SHUTDOWNOPTIONS       2204
#define                 IDC_STATIC_TEXT1                2205
#define                 IDC_RADIO_PLANNED               2218
#define                 IDC_RADIO_NOTPLANNED            2219
// IDOK
// IDCANCEL
//-----------------------------------------------------------------------------
// Logoff dialog
#define                 IDD_LOGOFFDLG                   2250
#define                 IDC_ICON_KEY2                   2251
// IDOK
// IDCANCEL
//-----------------------------------------------------------------------------
// "Please wait"-dialog
#define                 IDD_PLEASEWAITDLG               2450
#define                 IDC_STATIC_TEXT1                2451
//-----------------------------------------------------------------------------
// Unknown dialog
#define                 IDD_MESSAGEBOXDLG               2500
// IDOK
#define                 IDC_EDIT_TEXT1                  2501
*/

//-----------------------------------------------------------------------------
// The real logon dialog
#define		IDX_LOGONDLG					1500
#define		IDX_STATIC_USERNAME				1506
#define		IDX_EDIT_USERNAME				1502
#define		IDX_STATIC_PASSWORD				1507
#define		IDX_EDIT_PASSWORD				1503
#define		IDX_STATIC_DOMAIN				1508
#define		IDX_COMBO_DOMAIN				1504
#define		IDX_CHECK_RAS					1505
#define		IDX_ICON_KBDLAYOUT				2406
// #define		IDOK
// #define		IDCANCEL
#define		IDX_BTN_SHUTDOWN1				1501
#define		IDX_BTN_OPTIONS					1514
#define		IDX_STATIC_LEGALNOTES			2400
//-----------------------------------------------------------------------------
// Windows security dialog
#define		IDX_WINSECDLG					1800
#define		IDX_BTN_LOCK					1800
#define		IDX_BTN_LOGOFF					1801
#define		IDX_BTN_SHUTDOWN2				1802
#define		IDX_BTN_CHANGEPASS				1803
#define		IDX_BTN_TASKMAN					1804
// #define		IDCANCEL
#define		IDX_STATIC_TASKMANDESC			1805
#define		IDX_GROUP_INFOS					1657
#define		IDX_STATIC_LOGONNAME			1806
#define		IDX_STATIC_LOGONDATETEXT		1659
#define		IDX_STATIC_LOGONDATE			1807


typedef BOOL (WINAPI * PFWLXNEGOTIATE)  (DWORD, DWORD *);
typedef BOOL (WINAPI * PFWLXINITIALIZE) (LPWSTR, HANDLE, PVOID, PVOID, PVOID *);
typedef VOID (WINAPI * PFWLXDISPLAYSASNOTICE) (PVOID);
typedef int  (WINAPI * PFWLXLOGGEDOUTSAS) (PVOID, DWORD, PLUID, PSID, PDWORD, PHANDLE, PWLX_MPR_NOTIFY_INFO, PVOID *);
typedef BOOL (WINAPI * PFWLXACTIVATEUSERSHELL) (PVOID, PWSTR, PWSTR, PVOID);
typedef int  (WINAPI * PFWLXLOGGEDONSAS) (PVOID, DWORD, PVOID);
typedef VOID (WINAPI * PFWLXDISPLAYLOCKEDNOTICE) (PVOID);
typedef int  (WINAPI * PFWLXWKSTALOCKEDSAS) (PVOID, DWORD);
typedef BOOL (WINAPI * PFWLXISLOCKOK) (PVOID);
typedef BOOL (WINAPI * PFWLXISLOGOFFOK) (PVOID);
typedef VOID (WINAPI * PFWLXLOGOFF) (PVOID);
typedef VOID (WINAPI * PFWLXSHUTDOWN) (PVOID, DWORD);

//
// New for version 1.1
//

typedef BOOL (WINAPI * PFWLXSCREENSAVERNOTIFY) (PVOID, BOOL *);
typedef BOOL (WINAPI * PFWLXSTARTAPPLICATION) (PVOID, PWSTR, PVOID, PWSTR);

//
// New for version 1.3
//

typedef BOOL (WINAPI * PFWLXNETWORKPROVIDERLOAD) (PVOID, PWLX_MPR_NOTIFY_INFO);
typedef BOOL (WINAPI * PFWLXDISPLAYSTATUSMESSAGE) (PVOID, HDESK, DWORD, PWSTR, PWSTR);
typedef BOOL (WINAPI * PFWLXGETSTATUSMESSAGE) (PVOID, DWORD *, PWSTR, DWORD);
typedef BOOL (WINAPI * PFWLXREMOVESTATUSMESSAGE) (PVOID);

//
// New for version 1.4
//
typedef BOOL (WINAPI * PFWLXGETCONSOLESWITCHCREDENTIALS) (PVOID, PVOID);
typedef VOID (WINAPI * PFWLXRECONNECTNOTIFY) (PVOID);
typedef VOID (WINAPI * PFWLXDISCONNECTNOTIFY) (PVOID);

// Private structures
typedef struct tagGinaFunctions
{
// For version 1.0
	PFWLXNEGOTIATE pfWlxNegotiate;
	PFWLXINITIALIZE pfWlxInitialize;
	PFWLXDISPLAYSASNOTICE pfWlxDisplaySASNotice;
	PFWLXLOGGEDOUTSAS pfWlxLoggedOutSAS;
	PFWLXACTIVATEUSERSHELL pfWlxActivateUserShell;
	PFWLXLOGGEDONSAS pfWlxLoggedOnSAS;
	PFWLXDISPLAYLOCKEDNOTICE pfWlxDisplayLockedNotice;
	PFWLXWKSTALOCKEDSAS pfWlxWkstaLockedSAS;
	PFWLXISLOCKOK pfWlxIsLockOk;
	PFWLXISLOGOFFOK pfWlxIsLogoffOk;
	PFWLXLOGOFF pfWlxLogoff;
	PFWLXSHUTDOWN pfWlxShutdown;
// New for version 1.1
	PFWLXSCREENSAVERNOTIFY pfWlxScreenSaverNotify;
	PFWLXSTARTAPPLICATION pfWlxStartApplication;
// New for 1.3
	PFWLXNETWORKPROVIDERLOAD pfWlxNetworkProviderLoad;
	PFWLXDISPLAYSTATUSMESSAGE pfWlxDisplayStatusMessage;
	PFWLXGETSTATUSMESSAGE pfWlxGetStatusMessage;
	PFWLXREMOVESTATUSMESSAGE pfWlxRemoveStatusMessage;
// New for 1.4
	PFWLXGETCONSOLESWITCHCREDENTIALS pfWlxGetConsoleSwitchCredentials;
	PFWLXRECONNECTNOTIFY pfWlxReconnectNotify;
	PFWLXDISCONNECTNOTIFY pfWlxDisconnectNotify;
} GinaFuncs, *PGinaFuncs;

const DWORD MY_WLX_CURRENT_VERSION = WLX_VERSION_1_4;
typedef WLX_DISPATCH_VERSION_1_4 WLX_DISPATCH_VERSION_CURRENT, *PWLX_DISPATCH_VERSION_CURRENT;

typedef struct tagMyGINA
{
	GinaFuncs pf;
	PWLX_DISPATCH_VERSION_CURRENT OrigWinlogonFunctions;
	WLX_DISPATCH_VERSION_CURRENT PassWinlogonFunctions;
	HANDLE hWinlogon;
	HMODULE hOldGina;
	CString sWindowStation;
	DWORD dwSupportedVersion;
	DLGPROC pfWlxLogonDlgProc;
	DLGPROC pfWlxWinSecDlgProc;
	CWinThread* pServerThread;
	CWinThread* pRegistryThread;
} MyGINA, *PMyGINA;